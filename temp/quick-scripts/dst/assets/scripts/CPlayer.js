
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/CPlayer.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'c90b5cwF5ZKgbNi6oY6LKVY', 'CPlayer');
// scripts/CPlayer.js

"use strict";

var Types = require("Types");

var Utility = require("Utility");

var CPlayer = cc.Class({
  "extends": cc.Component,
  properties: {
    avatar: cc.Node,
    displayName: cc.Label,
    gold: cc.Label,
    spriteAvatar: {
      "default": [],
      type: [cc.SpriteFrame]
    },
    layerCard: {
      "default": null,
      type: cc.Node
    },
    imgPass: {
      "default": null,
      type: cc.Node
    },
    progressBar: {
      "default": null,
      type: cc.ProgressBar
    },
    headProgressBar: {
      "default": null,
      type: cc.ParticleSystem
    },
    backCard: {
      "default": null,
      type: cc.Sprite
    },
    lbNumCard: {
      "default": null,
      type: cc.Label
    }
  },
  ctor: function ctor() {
    /** @type {Player}*/
    this.player = null;
    /** @type {GameController}*/

    this.gameController = null;
    /** @type {[cardPrefab]}*/

    this.cards = [];
    this._isMyTurn = false;
    this._numCard = 0;
  },
  onLoad: function onLoad() {
    this.setMyTurn(this._isMyTurn);

    if (this.player) {
      this.displayName.string = this.player.name;
      this.gold.string = Utility.formatMoneyFull(this.player.gold); // var circleAvatar = this.avatar.getComponent("CCircleAvatar");
      // circleAvatar.changeAvatar(this.spriteAvatar[this.player.avatar]);
      //loadCards

      this._loadCards();
    } else {
      console.error("need load setPlayer info onLoad");
    }

    if (this.imgPass) {
      this.imgPass.active = false;
    }
  },
  start: function start() {},
  update: function update(dt) {
    if (this._isMyTurn) {
      var progressBar = this.progressBar;
      var progress = progressBar.progress;

      if (progress > 0) {
        progress -= dt * 0.1;
      }

      progressBar.progress = progress;
      var p = new cc.Vec2(0, 70);
      p = p.rotate(progress * 2 * 3.14);
      this.headProgressBar.node.setPosition(p);
    }
  },
  setGameController: function setGameController(gameController) {
    this.gameController = gameController;
  },
  setPlayer: function setPlayer(player) {
    this.player = player;

    if (this.player.index !== 0) {
      this._numCard = 11;
    }
  },
  updateUI: function updateUI() {},
  _loadCards: function _loadCards() {
    if (this.gameController) {
      var cards = this.player.cards;

      for (var i = 0; i < cards.length; i++) {
        var c = cards[i];
        var cardPrefab = this.gameController.getNewCard();
        var cCard = cardPrefab.getComponent("CCard");
        cCard.setCard(c);
        cCard.index = i;
        cCard.setOwner(this);
        var p = this.getPositionCard(cCard);
        var r = this.getRotationCard(cCard);
        cardPrefab.setPosition(p);
        cardPrefab.angle = -r;
        this.layerCard.addChild(cardPrefab);
        this.cards.push(cardPrefab);
      }

      this.lbNumCard.string = this.getNumCard();
    } else {
      console.error("don't have GameControler in Player, so can't create newCard");
    }
  },
  setLayerCard: function setLayerCard(layerCard) {
    this.layerCard = layerCard;
  },
  onDiscard: function onDiscard(cards) {
    this.setMyTurn(false);

    if (this.layerCard == null) {
      console.error("you need add layerCard to player beforeDiscard");
      return [];
    }

    var cardPrefabs = [];

    if (this.player && this.player.index === 0) {
      var isContain = function isContain(c) {
        for (var i = 0; i < cards.length; i++) {
          if (c.id === cards[i].id) {
            return true;
          }
        }

        return false;
      };

      var len = this.cards.length;

      for (var i = len - 1; i >= 0; i--) {
        var cardPrefab = this.cards[i];
        var cCard = cardPrefab.getComponent("CCard");

        if (isContain(cCard.card)) {
          cardPrefabs.unshift(cardPrefab);
          this.cards.splice(i, 1);
          this.player.cards.splice(i, 1);
        }
      }

      this._updatePosCards();
    } else {
      var pos = this.node.getPosition();
      pos.x += this.backCard.node.getPosition().x;

      for (var k = 0; k < cards.length; k++) {
        var cardPrefab = this.gameController.getNewCard();
        var cCard = cardPrefab.getComponent("CCard");
        cCard.setCard(cards[k]);
        cardPrefab.angle = 0;
        cCard.setPositionCenter(pos);
        cardPrefabs.push(cardPrefab);
        this.layerCard.addChild(cardPrefab);
      }

      this._numCard -= cards.length;
    }

    this.lbNumCard.string = this.getNumCard();
    return cardPrefabs;
  },
  _updatePosCards: function _updatePosCards() {
    console.log("_updatePosCards");

    if (this.gameController) {
      var cards = this.cards;

      for (var i = 0; i < cards.length; i++) {
        var cardPrefab = cards[i];
        var cCard = cardPrefab.getComponent("CCard");
        cCard.index = i;
        var p = this.getPositionCard(cCard);
        var r = this.getRotationCard(cCard);
        cardPrefab.setPosition(p);
        cardPrefab.angle = -r;
      }
    } else {
      console.error("don't have GameControler in Player, so can't create newCard");
    }
  },
  getNumCard: function getNumCard() {
    if (this.player) {
      if (this.player.index !== 0) {
        return this._numCard;
      }

      return this.player.cards.length;
    }

    return 1;
  },
  getRotationCard: function getRotationCard(cCard) {
    var index = cCard.index;
    return this.getRotationVia(index);
  },
  getRotationVia: function getRotationVia(index) {
    var num = this.getNumCard();
    var y = 0;
    var startX = -60;
    var endX = 48;
    var maxOffsetX = 12;
    var offset = (endX - startX) / (num - 1);
    if (offset > maxOffsetX) offset = maxOffsetX; //re-call startX;

    startX = startX + (endX - startX - offset * (num - 1)) / 2;
    return startX + offset * index;
  },

  /**
   *
   * @param cCard {CCard}
   */
  getPositionCard: function getPositionCard(cCard) {
    var index = cCard.index;
    return this.getPositionVia(index);
  },
  getPositionVia: function getPositionVia(index) {
    var num = this.getNumCard();
    var y = 0;
    var startX = -250;
    var endX = 250;
    var maxOffsetX = 5;
    var offset = (endX - startX) / (num - 1);
    if (offset > maxOffsetX) offset = maxOffsetX; //re-call startX;

    startX = startX + (endX - startX - offset * (num - 1)) / 2;
    return this.getCirclePos(new cc.Vec2(startX + offset * index, y));
  },

  /**
   *
   * @param pos {cc.Vec2}
   */
  getCirclePos: function getCirclePos(pos) {
    var x = pos.x;
    pos.y = -1 / 250 * (x * x) - 450;
    return pos;
  },
  onPass: function onPass() {
    this.setMyTurn(false);

    if (this.imgPass) {
      this.imgPass.active = true;
      this.node.runAction(cc.sequence(cc.delayTime(2), cc.callFunc(function () {
        this.imgPass.active = false;
      }.bind(this))));
    }
  },

  /**
   *
   * @param event {cc.EventTouch}
   * @param card {Card}
   */
  onTouchCard: function onTouchCard(event, card, owner) {
    switch (event.type) {
      case cc.Node.EventType.TOUCH_START:
        break;

      case cc.Node.EventType.TOUCH_MOVE:
        card.isDraging = true;
        var pos = card.node.getParent().convertToNodeSpaceAR(event.getLocation());
        card.node.setPosition(pos);
        break;

      case cc.Node.EventType.TOUCH_END:
        card.isDraging = false;
        card.isSelected = !card.isSelected;
        card.node.setPosition(this.getPositionCard(card));
        break;

      case cc.Node.EventType.TOUCH_CANCEL:
        card.isDraging = false;
        card.node.setPosition(this.getPositionCard(card));
        break;
    }
  },
  onEnterTurn: function onEnterTurn() {
    if (this.player.index === 0) return;
    this.progressBar.progress = 1;
    this.setMyTurn(true);
  },
  setMyTurn: function setMyTurn(b) {
    var index = 1;
    console.log("come:" + index++);
    this._isMyTurn = b;
    console.log("come:" + index++);
    this.progressBar.node.active = b;
    console.log("come:" + index++);
    var len = this.cards.length;

    for (var i = 0; i < len; i++) {
      var cardPrefab = this.cards[i];
      var cCard = cardPrefab.getComponent("CCard");
      cCard.setSuggest(true);
    }

    console.log("come:" + index++);

    if (!b) {
      this.headProgressBar.stopSystem();
    } else {
      this.headProgressBar.resetSystem();
    }

    console.log("come:" + index++); // this.headProgressBar.active = b;
  },
  onSuggestCard: function onSuggestCard(cards) {
    var isContain = function isContain(card) {
      var l = cards.length;

      for (var i = 0; i < l; i++) {
        if (cards[i].id === card.id) {
          return true;
        }
      }

      return false;
    };

    var len = this.cards.length;

    for (var i = 0; i < len; i++) {
      var cardPrefab = this.cards[i];
      var cCard = cardPrefab.getComponent("CCard");
      cCard.setSuggest(isContain(cCard.card));
    }
  }
});
module.exports = CPlayer;

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcQ1BsYXllci5qcyJdLCJuYW1lcyI6WyJUeXBlcyIsInJlcXVpcmUiLCJVdGlsaXR5IiwiQ1BsYXllciIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiYXZhdGFyIiwiTm9kZSIsImRpc3BsYXlOYW1lIiwiTGFiZWwiLCJnb2xkIiwic3ByaXRlQXZhdGFyIiwidHlwZSIsIlNwcml0ZUZyYW1lIiwibGF5ZXJDYXJkIiwiaW1nUGFzcyIsInByb2dyZXNzQmFyIiwiUHJvZ3Jlc3NCYXIiLCJoZWFkUHJvZ3Jlc3NCYXIiLCJQYXJ0aWNsZVN5c3RlbSIsImJhY2tDYXJkIiwiU3ByaXRlIiwibGJOdW1DYXJkIiwiY3RvciIsInBsYXllciIsImdhbWVDb250cm9sbGVyIiwiY2FyZHMiLCJfaXNNeVR1cm4iLCJfbnVtQ2FyZCIsIm9uTG9hZCIsInNldE15VHVybiIsInN0cmluZyIsIm5hbWUiLCJmb3JtYXRNb25leUZ1bGwiLCJfbG9hZENhcmRzIiwiY29uc29sZSIsImVycm9yIiwiYWN0aXZlIiwic3RhcnQiLCJ1cGRhdGUiLCJkdCIsInByb2dyZXNzIiwicCIsIlZlYzIiLCJyb3RhdGUiLCJub2RlIiwic2V0UG9zaXRpb24iLCJzZXRHYW1lQ29udHJvbGxlciIsInNldFBsYXllciIsImluZGV4IiwidXBkYXRlVUkiLCJpIiwibGVuZ3RoIiwiYyIsImNhcmRQcmVmYWIiLCJnZXROZXdDYXJkIiwiY0NhcmQiLCJnZXRDb21wb25lbnQiLCJzZXRDYXJkIiwic2V0T3duZXIiLCJnZXRQb3NpdGlvbkNhcmQiLCJyIiwiZ2V0Um90YXRpb25DYXJkIiwiYW5nbGUiLCJhZGRDaGlsZCIsInB1c2giLCJnZXROdW1DYXJkIiwic2V0TGF5ZXJDYXJkIiwib25EaXNjYXJkIiwiY2FyZFByZWZhYnMiLCJpc0NvbnRhaW4iLCJpZCIsImxlbiIsImNhcmQiLCJ1bnNoaWZ0Iiwic3BsaWNlIiwiX3VwZGF0ZVBvc0NhcmRzIiwicG9zIiwiZ2V0UG9zaXRpb24iLCJ4IiwiayIsInNldFBvc2l0aW9uQ2VudGVyIiwibG9nIiwiZ2V0Um90YXRpb25WaWEiLCJudW0iLCJ5Iiwic3RhcnRYIiwiZW5kWCIsIm1heE9mZnNldFgiLCJvZmZzZXQiLCJnZXRQb3NpdGlvblZpYSIsImdldENpcmNsZVBvcyIsIm9uUGFzcyIsInJ1bkFjdGlvbiIsInNlcXVlbmNlIiwiZGVsYXlUaW1lIiwiY2FsbEZ1bmMiLCJiaW5kIiwib25Ub3VjaENhcmQiLCJldmVudCIsIm93bmVyIiwiRXZlbnRUeXBlIiwiVE9VQ0hfU1RBUlQiLCJUT1VDSF9NT1ZFIiwiaXNEcmFnaW5nIiwiZ2V0UGFyZW50IiwiY29udmVydFRvTm9kZVNwYWNlQVIiLCJnZXRMb2NhdGlvbiIsIlRPVUNIX0VORCIsImlzU2VsZWN0ZWQiLCJUT1VDSF9DQU5DRUwiLCJvbkVudGVyVHVybiIsImIiLCJzZXRTdWdnZXN0Iiwic3RvcFN5c3RlbSIsInJlc2V0U3lzdGVtIiwib25TdWdnZXN0Q2FyZCIsImwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBbkI7O0FBQ0EsSUFBSUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsU0FBRCxDQUFyQjs7QUFFQSxJQUFJRSxPQUFPLEdBQUdDLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ25CLGFBQVNELEVBQUUsQ0FBQ0UsU0FETztBQUduQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1JDLElBQUFBLE1BQU0sRUFBQ0osRUFBRSxDQUFDSyxJQURGO0FBRVJDLElBQUFBLFdBQVcsRUFBQ04sRUFBRSxDQUFDTyxLQUZQO0FBR1JDLElBQUFBLElBQUksRUFBQ1IsRUFBRSxDQUFDTyxLQUhBO0FBSVJFLElBQUFBLFlBQVksRUFBQztBQUNULGlCQUFRLEVBREM7QUFFVEMsTUFBQUEsSUFBSSxFQUFDLENBQUNWLEVBQUUsQ0FBQ1csV0FBSjtBQUZJLEtBSkw7QUFR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QUssQ0FBQ2lCLElBQVAsQ0FBMUI7QUFDSDtBQUNKO0FBalVrQixDQUFULENBQWQ7QUFvVUE2QyxNQUFNLENBQUNDLE9BQVAsR0FBaUJ0SCxPQUFqQiIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFR5cGVzID0gcmVxdWlyZShcIlR5cGVzXCIpO1xyXG52YXIgVXRpbGl0eSA9IHJlcXVpcmUoXCJVdGlsaXR5XCIpO1xyXG5cclxudmFyIENQbGF5ZXIgPSBjYy5DbGFzcyh7XHJcbiAgICBleHRlbmRzOiBjYy5Db21wb25lbnQsXHJcblxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIGF2YXRhcjpjYy5Ob2RlLFxyXG4gICAgICAgIGRpc3BsYXlOYW1lOmNjLkxhYmVsLFxyXG4gICAgICAgIGdvbGQ6Y2MuTGFiZWwsXHJcbiAgICAgICAgc3ByaXRlQXZhdGFyOntcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICAgICAgdHlwZTpbY2MuU3ByaXRlRnJhbWVdXHJcbiAgICAgICAgfSxcclxuICAgICAgICBsYXllckNhcmQ6e1xyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaW1nUGFzczp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwcm9ncmVzc0Jhcjp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5Qcm9ncmVzc0JhclxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaGVhZFByb2dyZXNzQmFyOntcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgICAgICB0eXBlOmNjLlBhcnRpY2xlU3lzdGVtXHJcbiAgICAgICAgfSxcclxuICAgICAgICBiYWNrQ2FyZDp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxiTnVtQ2FyZDp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5MYWJlbFxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBjdG9yOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgLyoqIEB0eXBlIHtQbGF5ZXJ9Ki9cclxuICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgLyoqIEB0eXBlIHtHYW1lQ29udHJvbGxlcn0qL1xyXG4gICAgICAgIHRoaXMuZ2FtZUNvbnRyb2xsZXIgPSBudWxsO1xyXG4gICAgICAgIC8qKiBAdHlwZSB7W2NhcmRQcmVmYWJdfSovXHJcbiAgICAgICAgdGhpcy5jYXJkcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuX2lzTXlUdXJuID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fbnVtQ2FyZCA9IDA7XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5zZXRNeVR1cm4odGhpcy5faXNNeVR1cm4pO1xyXG4gICAgICAgIGlmKHRoaXMucGxheWVyKXtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5TmFtZS5zdHJpbmcgPSB0aGlzLnBsYXllci5uYW1lO1xyXG4gICAgICAgICAgICB0aGlzLmdvbGQuc3RyaW5nID0gVXRpbGl0eS5mb3JtYXRNb25leUZ1bGwodGhpcy5wbGF5ZXIuZ29sZCk7XHJcblxyXG4gICAgICAgICAgICAvLyB2YXIgY2lyY2xlQXZhdGFyID0gdGhpcy5hdmF0YXIuZ2V0Q29tcG9uZW50KFwiQ0NpcmNsZUF2YXRhclwiKTtcclxuICAgICAgICAgICAgLy8gY2lyY2xlQXZhdGFyLmNoYW5nZUF2YXRhcih0aGlzLnNwcml0ZUF2YXRhclt0aGlzLnBsYXllci5hdmF0YXJdKTtcclxuXHJcbiAgICAgICAgICAgIC8vbG9hZENhcmRzXHJcbiAgICAgICAgICAgIHRoaXMuX2xvYWRDYXJkcygpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwibmVlZCBsb2FkIHNldFBsYXllciBpbmZvIG9uTG9hZFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYodGhpcy5pbWdQYXNzKXtcclxuICAgICAgICAgICAgdGhpcy5pbWdQYXNzLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzdGFydDpmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcbiAgICAgICAgaWYodGhpcy5faXNNeVR1cm4pe1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3NCYXIgPSB0aGlzLnByb2dyZXNzQmFyO1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBwcm9ncmVzc0Jhci5wcm9ncmVzcztcclxuICAgICAgICAgICAgaWYocHJvZ3Jlc3MgPiAwKXtcclxuICAgICAgICAgICAgICAgIHByb2dyZXNzIC09IChkdCAqIDAuMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXIucHJvZ3Jlc3MgPSBwcm9ncmVzcztcclxuXHJcbiAgICAgICAgICAgIHZhciBwID0gbmV3IGNjLlZlYzIoMCw3MCk7XHJcbiAgICAgICAgICAgIHAgPSBwLnJvdGF0ZShwcm9ncmVzcyAqIDIgKiAzLjE0KTtcclxuICAgICAgICAgICAgdGhpcy5oZWFkUHJvZ3Jlc3NCYXIubm9kZS5zZXRQb3NpdGlvbihwKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIHNldEdhbWVDb250cm9sbGVyOmZ1bmN0aW9uKGdhbWVDb250cm9sbGVyKXtcclxuICAgICAgICB0aGlzLmdhbWVDb250cm9sbGVyID0gZ2FtZUNvbnRyb2xsZXI7XHJcbiAgICB9LFxyXG4gICAgc2V0UGxheWVyOmZ1bmN0aW9uIChwbGF5ZXIpIHtcclxuICAgICAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcclxuICAgICAgICBpZih0aGlzLnBsYXllci5pbmRleCAhPT0gMCl7XHJcbiAgICAgICAgICAgIHRoaXMuX251bUNhcmQgPSAxMTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgdXBkYXRlVUk6ZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcbiAgICBfbG9hZENhcmRzOmZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZih0aGlzLmdhbWVDb250cm9sbGVyKXtcclxuICAgICAgICAgICAgdmFyIGNhcmRzID0gdGhpcy5wbGF5ZXIuY2FyZHM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjID0gY2FyZHNbaV07XHJcbiAgICAgICAgICAgICAgICB2YXIgY2FyZFByZWZhYiA9IHRoaXMuZ2FtZUNvbnRyb2xsZXIuZ2V0TmV3Q2FyZCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNDYXJkID0gY2FyZFByZWZhYi5nZXRDb21wb25lbnQoXCJDQ2FyZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjQ2FyZC5zZXRDYXJkKGMpO1xyXG4gICAgICAgICAgICAgICAgY0NhcmQuaW5kZXggPSAoaSk7XHJcbiAgICAgICAgICAgICAgICBjQ2FyZC5zZXRPd25lcih0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcCA9IHRoaXMuZ2V0UG9zaXRpb25DYXJkKGNDYXJkKTtcclxuICAgICAgICAgICAgICAgIHZhciByID0gdGhpcy5nZXRSb3RhdGlvbkNhcmQoY0NhcmQpO1xyXG4gICAgICAgICAgICAgICAgY2FyZFByZWZhYi5zZXRQb3NpdGlvbihwKTtcclxuICAgICAgICAgICAgICAgIGNhcmRQcmVmYWIuYW5nbGUgPSAoLXIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXllckNhcmQuYWRkQ2hpbGQoY2FyZFByZWZhYik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhcmRzLnB1c2goY2FyZFByZWZhYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sYk51bUNhcmQuc3RyaW5nID0gdGhpcy5nZXROdW1DYXJkKCk7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJkb24ndCBoYXZlIEdhbWVDb250cm9sZXIgaW4gUGxheWVyLCBzbyBjYW4ndCBjcmVhdGUgbmV3Q2FyZFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgc2V0TGF5ZXJDYXJkOmZ1bmN0aW9uKGxheWVyQ2FyZCl7XHJcbiAgICAgICAgdGhpcy5sYXllckNhcmQgPSBsYXllckNhcmQ7XHJcbiAgICB9LFxyXG4gICAgb25EaXNjYXJkOmZ1bmN0aW9uKGNhcmRzKXtcclxuICAgICAgICB0aGlzLnNldE15VHVybihmYWxzZSk7XHJcbiAgICAgICAgaWYodGhpcy5sYXllckNhcmQgPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJ5b3UgbmVlZCBhZGQgbGF5ZXJDYXJkIHRvIHBsYXllciBiZWZvcmVEaXNjYXJkXCIpO1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjYXJkUHJlZmFicyA9IFtdO1xyXG4gICAgICAgIGlmKHRoaXMucGxheWVyICYmIHRoaXMucGxheWVyLmluZGV4ID09PSAwKXtcclxuICAgICAgICAgICAgdmFyIGlzQ29udGFpbiA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNhcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoYy5pZD09PSBjYXJkc1tpXS5pZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgdmFyIGxlbiA9IHRoaXMuY2FyZHMubGVuZ3RoO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gbGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBjYXJkUHJlZmFiID0gdGhpcy5jYXJkc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBjQ2FyZCA9IGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KFwiQ0NhcmRcIik7XHJcbiAgICAgICAgICAgICAgICBpZihpc0NvbnRhaW4oY0NhcmQuY2FyZCkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNhcmRQcmVmYWJzLnVuc2hpZnQoY2FyZFByZWZhYik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXJkcy5zcGxpY2UoaSwxKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllci5jYXJkcy5zcGxpY2UoaSwxKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLl91cGRhdGVQb3NDYXJkcygpO1xyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICB2YXIgcG9zID0gdGhpcy5ub2RlLmdldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgICAgIHBvcy54ICs9IHRoaXMuYmFja0NhcmQubm9kZS5nZXRQb3NpdGlvbigpLng7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgY2FyZHMubGVuZ3RoOyBrKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjYXJkUHJlZmFiID0gdGhpcy5nYW1lQ29udHJvbGxlci5nZXROZXdDYXJkKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgY0NhcmQgPSBjYXJkUHJlZmFiLmdldENvbXBvbmVudChcIkNDYXJkXCIpO1xyXG4gICAgICAgICAgICAgICAgY0NhcmQuc2V0Q2FyZChjYXJkc1trXSk7XHJcbiAgICAgICAgICAgICAgICBjYXJkUHJlZmFiLmFuZ2xlID0gMDtcclxuICAgICAgICAgICAgICAgIGNDYXJkLnNldFBvc2l0aW9uQ2VudGVyKHBvcyk7XHJcbiAgICAgICAgICAgICAgICBjYXJkUHJlZmFicy5wdXNoKGNhcmRQcmVmYWIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXllckNhcmQuYWRkQ2hpbGQoY2FyZFByZWZhYik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5fbnVtQ2FyZCAtPSBjYXJkcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubGJOdW1DYXJkLnN0cmluZyA9IHRoaXMuZ2V0TnVtQ2FyZCgpO1xyXG4gICAgICAgIHJldHVybiBjYXJkUHJlZmFicztcclxuICAgIH0sXHJcbiAgICBfdXBkYXRlUG9zQ2FyZHM6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIl91cGRhdGVQb3NDYXJkc1wiKTtcclxuICAgICAgICBpZih0aGlzLmdhbWVDb250cm9sbGVyKXtcclxuICAgICAgICAgICAgdmFyIGNhcmRzID0gdGhpcy5jYXJkcztcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYXJkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhcmRQcmVmYWIgPSBjYXJkc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBjQ2FyZCA9IGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KFwiQ0NhcmRcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgY0NhcmQuaW5kZXggPSAoaSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHAgPSB0aGlzLmdldFBvc2l0aW9uQ2FyZChjQ2FyZCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuZ2V0Um90YXRpb25DYXJkKGNDYXJkKTtcclxuICAgICAgICAgICAgICAgIGNhcmRQcmVmYWIuc2V0UG9zaXRpb24ocCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkUHJlZmFiLmFuZ2xlID0gKC1yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiZG9uJ3QgaGF2ZSBHYW1lQ29udHJvbGVyIGluIFBsYXllciwgc28gY2FuJ3QgY3JlYXRlIG5ld0NhcmRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBnZXROdW1DYXJkOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgaWYodGhpcy5wbGF5ZXIpe1xyXG4gICAgICAgICAgICBpZih0aGlzLnBsYXllci5pbmRleCAhPT0gMCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbnVtQ2FyZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wbGF5ZXIuY2FyZHMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gMTtcclxuICAgIH0sXHJcbiAgICBnZXRSb3RhdGlvbkNhcmQ6ZnVuY3Rpb24gKGNDYXJkKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gY0NhcmQuaW5kZXg7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Um90YXRpb25WaWEoaW5kZXgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXRSb3RhdGlvblZpYTpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIG51bSA9IHRoaXMuZ2V0TnVtQ2FyZCgpO1xyXG4gICAgICAgIHZhciB5ID0gMDtcclxuICAgICAgICB2YXIgc3RhcnRYID0gLTYwO1xyXG4gICAgICAgIHZhciBlbmRYID0gNDg7XHJcbiAgICAgICAgdmFyIG1heE9mZnNldFggPSAxMjtcclxuICAgICAgICB2YXIgb2Zmc2V0ID0gKGVuZFggLSBzdGFydFgpIC8gKG51bSAtIDEpO1xyXG4gICAgICAgIGlmKG9mZnNldCA+IG1heE9mZnNldFgpIG9mZnNldCA9IG1heE9mZnNldFg7XHJcbiAgICAgICAgLy9yZS1jYWxsIHN0YXJ0WDtcclxuICAgICAgICBzdGFydFggPSBzdGFydFggKyAgKGVuZFggLSBzdGFydFggLSAob2Zmc2V0ICoobnVtIC0gMSkpKS8yO1xyXG4gICAgICAgIHJldHVybiBzdGFydFggKyAob2Zmc2V0ICogaW5kZXgpO1xyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjQ2FyZCB7Q0NhcmR9XHJcbiAgICAgKi9cclxuICAgIGdldFBvc2l0aW9uQ2FyZDpmdW5jdGlvbiAoY0NhcmQpe1xyXG4gICAgICAgIHZhciBpbmRleCA9IGNDYXJkLmluZGV4O1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFBvc2l0aW9uVmlhKGluZGV4KTtcclxuICAgIH0sXHJcbiAgICBnZXRQb3NpdGlvblZpYTpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgdmFyIG51bSA9IHRoaXMuZ2V0TnVtQ2FyZCgpO1xyXG4gICAgICAgIHZhciB5ID0gMDtcclxuICAgICAgICB2YXIgc3RhcnRYID0gLSAyNTA7XHJcbiAgICAgICAgdmFyIGVuZFggPSAyNTA7XHJcbiAgICAgICAgdmFyIG1heE9mZnNldFggPSA1O1xyXG4gICAgICAgIHZhciBvZmZzZXQgPSAoZW5kWCAtIHN0YXJ0WCkgLyAobnVtIC0gMSk7XHJcbiAgICAgICAgaWYob2Zmc2V0ID4gbWF4T2Zmc2V0WCkgb2Zmc2V0ID0gbWF4T2Zmc2V0WDtcclxuICAgICAgICAvL3JlLWNhbGwgc3RhcnRYO1xyXG4gICAgICAgIHN0YXJ0WCA9IHN0YXJ0WCArICAoZW5kWCAtIHN0YXJ0WCAtIChvZmZzZXQgKihudW0gLSAxKSkpLzI7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2lyY2xlUG9zKG5ldyBjYy5WZWMyKHN0YXJ0WCArIChvZmZzZXQgKiBpbmRleCksIHkpKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcG9zIHtjYy5WZWMyfVxyXG4gICAgICovXHJcbiAgICBnZXRDaXJjbGVQb3M6ZnVuY3Rpb24gKHBvcykge1xyXG4gICAgICAgIHZhciB4ID0gcG9zLng7XHJcbiAgICAgICAgcG9zLnkgPSAoLTEvMjUwKih4KngpIC0gNDUwKTtcclxuICAgICAgICByZXR1cm4gcG9zO1xyXG4gICAgfSxcclxuICAgIG9uUGFzczpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5zZXRNeVR1cm4oZmFsc2UpO1xyXG4gICAgICAgIGlmKHRoaXMuaW1nUGFzcyl7XHJcbiAgICAgICAgICAgIHRoaXMuaW1nUGFzcy5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLm5vZGUucnVuQWN0aW9uKGNjLnNlcXVlbmNlKFxyXG4gICAgICAgICAgICAgICAgY2MuZGVsYXlUaW1lKDIpLFxyXG4gICAgICAgICAgICAgICAgY2MuY2FsbEZ1bmMoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW1nUGFzcy5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0uYmluZCh0aGlzKSlcclxuICAgICAgICAgICAgKSlcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGV2ZW50IHtjYy5FdmVudFRvdWNofVxyXG4gICAgICogQHBhcmFtIGNhcmQge0NhcmR9XHJcbiAgICAgKi9cclxuICAgIG9uVG91Y2hDYXJkOmZ1bmN0aW9uIChldmVudCxjYXJkLG93bmVyKSB7XHJcbiAgICAgICAgc3dpdGNoIChldmVudC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9NT1ZFOlxyXG4gICAgICAgICAgICAgICAgY2FyZC5pc0RyYWdpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBvcyA9IGNhcmQubm9kZS5nZXRQYXJlbnQoKS5jb252ZXJ0VG9Ob2RlU3BhY2VBUihldmVudC5nZXRMb2NhdGlvbigpKTtcclxuICAgICAgICAgICAgICAgIGNhcmQubm9kZS5zZXRQb3NpdGlvbihwb3MpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5EOlxyXG4gICAgICAgICAgICAgICAgY2FyZC5pc0RyYWdpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNhcmQuaXNTZWxlY3RlZCA9ICFjYXJkLmlzU2VsZWN0ZWQ7XHJcbiAgICAgICAgICAgICAgICBjYXJkLm5vZGUuc2V0UG9zaXRpb24odGhpcy5nZXRQb3NpdGlvbkNhcmQoY2FyZCkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMOlxyXG4gICAgICAgICAgICAgICAgY2FyZC5pc0RyYWdpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGNhcmQubm9kZS5zZXRQb3NpdGlvbih0aGlzLmdldFBvc2l0aW9uQ2FyZChjYXJkKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25FbnRlclR1cm46ZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmKHRoaXMucGxheWVyLmluZGV4ID09PSAwKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5wcm9ncmVzcyA9IDE7XHJcbiAgICAgICAgdGhpcy5zZXRNeVR1cm4odHJ1ZSk7XHJcbiAgICB9LFxyXG4gICAgc2V0TXlUdXJuOmZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImNvbWU6XCIgKyBpbmRleCsrKTtcclxuICAgICAgICB0aGlzLl9pc015VHVybiA9IGI7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjb21lOlwiICsgaW5kZXgrKyk7XHJcbiAgICAgICAgdGhpcy5wcm9ncmVzc0Jhci5ub2RlLmFjdGl2ZSA9IGI7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjb21lOlwiICsgaW5kZXgrKyk7XHJcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMuY2FyZHMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGNhcmRQcmVmYWIgPSB0aGlzLmNhcmRzW2ldO1xyXG4gICAgICAgICAgICB2YXIgY0NhcmQgPSBjYXJkUHJlZmFiLmdldENvbXBvbmVudChcIkNDYXJkXCIpO1xyXG4gICAgICAgICAgICBjQ2FyZC5zZXRTdWdnZXN0KHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyhcImNvbWU6XCIgKyBpbmRleCsrKTtcclxuICAgICAgICBpZighYil7XHJcbiAgICAgICAgICAgIHRoaXMuaGVhZFByb2dyZXNzQmFyLnN0b3BTeXN0ZW0oKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgdGhpcy5oZWFkUHJvZ3Jlc3NCYXIucmVzZXRTeXN0ZW0oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjb21lOlwiICsgaW5kZXgrKyk7XHJcbiAgICAgICAgLy8gdGhpcy5oZWFkUHJvZ3Jlc3NCYXIuYWN0aXZlID0gYjtcclxuICAgIH0sXHJcbiAgICBvblN1Z2dlc3RDYXJkOmZ1bmN0aW9uIChjYXJkcykge1xyXG4gICAgICAgIHZhciBpc0NvbnRhaW4gPSBmdW5jdGlvbiAoY2FyZCkge1xyXG4gICAgICAgICAgICB2YXIgbCA9IGNhcmRzLmxlbmd0aDtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGNhcmRzW2ldLmlkID09PSBjYXJkLmlkKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgbGVuID0gdGhpcy5jYXJkcy5sZW5ndGg7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgY2FyZFByZWZhYiA9IHRoaXMuY2FyZHNbaV07XHJcbiAgICAgICAgICAgIHZhciBjQ2FyZCA9IGNhcmRQcmVmYWIuZ2V0Q29tcG9uZW50KFwiQ0NhcmRcIik7XHJcbiAgICAgICAgICAgIGNDYXJkLnNldFN1Z2dlc3QoaXNDb250YWluKGNDYXJkLmNhcmQpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxufSk7XHJcbm1vZHVsZS5leHBvcnRzID0gQ1BsYXllcjtcclxuIl19