
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/CCard.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '34036kNa6RCAoMIlraaHio6', 'CCard');
// scripts/CCard.js

"use strict";

var _require = require("Types"),
    Card = _require.Card,
    Rank = _require.Rank; // import {Card} from "Types";

/**
 * @class CCard
 */


var CCard = cc.Class({
  "extends": cc.Component,
  properties: {
    // nodes
    point: cc.Label,
    suit: cc.Sprite,
    mainPic: cc.Sprite,
    cardBG: cc.Sprite,
    // resources
    redTextColor: cc.Color.RED,
    blackTextColor: cc.Color.WHITE,
    texFrontBG: cc.SpriteFrame,
    // texBackBG     : cc.SpriteFrame,
    texFaces: {
      //J,Q,K
      "default": [],
      type: cc.SpriteFrame
    },
    texAce: {
      "default": [],
      type: cc.SpriteFrame
    },
    texSuitBig: {
      "default": [],
      type: cc.SpriteFrame
    },
    texSuitSmall: {
      "default": [],
      type: cc.SpriteFrame
    },
    layerSuggest: {
      "default": null,
      type: cc.Node
    },
    index: {
      //vi tri trong group khi danh ra
      "default": 0,
      type: cc.Integer,
      visible: false
    },
    isSelected: {
      // trang thai co select khong
      "default": false,
      visible: false
    },
    owner: {
      //so huu quan bai, myPlayer hoac dock duoi table
      "default": null,
      type: cc.Node,
      visible: false
    },
    isDraging: {
      "default": true,
      visible: false
    },
    card: {
      "default": null,
      type: Card,
      visible: false
    }
  },

  /**
   * my player | dock
   * @param owner {cc.Node}
   */
  setOwner: function setOwner(owner) {
    this.owner = owner;
  },
  onLoad: function onLoad() {
    this.layerSuggest.active = false; // console.log("loadCard:" + this.card +"|" + this.index);

    if (this.card) {
      this.init(this.card);
    }

    this.node.on(cc.Node.EventType.TOUCH_START, this.onTouch, this);
    this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouch, this);
    this.node.on(cc.Node.EventType.TOUCH_END, this.onTouch, this);
    this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouch, this); // this.node.on("card-touch",this.onEmit,this);
  },
  onEmit: function onEmit() {
    console.log("card-touch:" + this.card.toString());
  },
  onTouch: function onTouch(event) {
    if (this.owner) {
      var customEvent = new cc.Event.EventCustom('card-touch', true);
      customEvent.setUserData({
        card: this,
        event: event
      });
      this.node.dispatchEvent(customEvent); // var cPlayer = this.owner.getComponent("CPlayer");
      // cPlayer.onTouchCard(event,this);
    } else {
      console.log("not found owner's card:" + this.id);
    }
  },
  start: function start() {
    this.node.dispatchEvent(new cc.Event.EventCustom('cardtouch', true));
  },
  setCard: function setCard(card) {
    // console.log("setCard:" + card +"|point:" + card.point +"|suit:" + card.suit);
    this.card = card;
  },
  // use this for initialization
  init: function init(card) {
    //chat
    this.suit.spriteFrame = this.texSuitSmall[card.suit]; //so

    if (card.isRedSuit) {
      this.point.node.color = this.redTextColor;
    } else {
      this.point.node.color = this.blackTextColor;
    }

    this.point.string = card.pointName; //hinh

    if (card.isAce) {
      this.mainPic.spriteFrame = this.texAce[card.suit];
    } else if (card.isFace) {
      this.mainPic.spriteFrame = this.texFaces[card.point - 8];

      if (card.isRedSuit) {
        this.mainPic.node.color = this.redTextColor;
      } else {
        this.mainPic.node.color = cc.Color.WHITE;
      }
    } else {
      //binh thuong 2->10
      this.mainPic.spriteFrame = this.texSuitBig[card.suit];
    }
  },
  setPositionCenter: function setPositionCenter(pos) {
    this.node.setPosition(pos.x - 73, pos.y - 98);
  },
  setSuggest: function setSuggest(b) {
    this.layerSuggest.active = !b;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL0NDYXJkLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJDYXJkIiwiUmFuayIsIkNDYXJkIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJwb2ludCIsIkxhYmVsIiwic3VpdCIsIlNwcml0ZSIsIm1haW5QaWMiLCJjYXJkQkciLCJyZWRUZXh0Q29sb3IiLCJDb2xvciIsIlJFRCIsImJsYWNrVGV4dENvbG9yIiwiV0hJVEUiLCJ0ZXhGcm9udEJHIiwiU3ByaXRlRnJhbWUiLCJ0ZXhGYWNlcyIsInR5cGUiLCJ0ZXhBY2UiLCJ0ZXhTdWl0QmlnIiwidGV4U3VpdFNtYWxsIiwibGF5ZXJTdWdnZXN0IiwiTm9kZSIsImluZGV4IiwiSW50ZWdlciIsInZpc2libGUiLCJpc1NlbGVjdGVkIiwib3duZXIiLCJpc0RyYWdpbmciLCJjYXJkIiwic2V0T3duZXIiLCJvbkxvYWQiLCJhY3RpdmUiLCJpbml0Iiwibm9kZSIsIm9uIiwiRXZlbnRUeXBlIiwiVE9VQ0hfU1RBUlQiLCJvblRvdWNoIiwiVE9VQ0hfTU9WRSIsIlRPVUNIX0VORCIsIlRPVUNIX0NBTkNFTCIsIm9uRW1pdCIsImNvbnNvbGUiLCJsb2ciLCJ0b1N0cmluZyIsImV2ZW50IiwiY3VzdG9tRXZlbnQiLCJFdmVudCIsIkV2ZW50Q3VzdG9tIiwic2V0VXNlckRhdGEiLCJkaXNwYXRjaEV2ZW50IiwiaWQiLCJzdGFydCIsInNldENhcmQiLCJzcHJpdGVGcmFtZSIsImlzUmVkU3VpdCIsImNvbG9yIiwic3RyaW5nIiwicG9pbnROYW1lIiwiaXNBY2UiLCJpc0ZhY2UiLCJzZXRQb3NpdGlvbkNlbnRlciIsInBvcyIsInNldFBvc2l0aW9uIiwieCIsInkiLCJzZXRTdWdnZXN0IiwiYiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7ZUFBa0JBLE9BQU8sQ0FBQyxPQUFEO0lBQXBCQyxnQkFBQUE7SUFBS0MsZ0JBQUFBLE1BQ1Y7O0FBQ0E7Ozs7O0FBR0Es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LE9BQUwsQ0FBYWdELFdBQWIsR0FBMkIsS0FBS3BDLFVBQUwsQ0FBZ0JVLElBQUksQ0FBQ3hCLElBQXJCLENBQTNCO0FBQ0g7QUFDSixHQW5JZ0I7QUFxSWpCeUQsRUFBQUEsaUJBQWlCLEVBQUMsMkJBQVVDLEdBQVYsRUFBZTtBQUM3QixTQUFLN0IsSUFBTCxDQUFVOEIsV0FBVixDQUFzQkQsR0FBRyxDQUFDRSxDQUFKLEdBQVEsRUFBOUIsRUFBaUNGLEdBQUcsQ0FBQ0csQ0FBSixHQUFRLEVBQXpDO0FBQ0gsR0F2SWdCO0FBd0lqQkMsRUFBQUEsVUFBVSxFQUFDLG9CQUFVQyxDQUFWLEVBQWE7QUFDcEIsU0FBSy9DLFlBQUwsQ0FBa0JXLE1BQWxCLEdBQTJCLENBQUNvQyxDQUE1QjtBQUNIO0FBMUlnQixDQUFULENBQVoiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbInZhciB7Q2FyZCxSYW5rfSA9IHJlcXVpcmUoXCJUeXBlc1wiKTtcclxuLy8gaW1wb3J0IHtDYXJkfSBmcm9tIFwiVHlwZXNcIjtcclxuLyoqXHJcbiAqIEBjbGFzcyBDQ2FyZFxyXG4gKi9cclxudmFyIENDYXJkID0gY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kczogY2MuQ29tcG9uZW50LFxyXG5cclxuICAgIHByb3BlcnRpZXM6IHtcclxuICAgICAgICAvLyBub2Rlc1xyXG4gICAgICAgIHBvaW50ICAgOiBjYy5MYWJlbCxcclxuICAgICAgICBzdWl0ICAgOiBjYy5TcHJpdGUsXHJcbiAgICAgICAgbWFpblBpYzogY2MuU3ByaXRlLFxyXG4gICAgICAgIGNhcmRCRyA6IGNjLlNwcml0ZSxcclxuXHJcbiAgICAgICAgLy8gcmVzb3VyY2VzXHJcbiAgICAgICAgcmVkVGV4dENvbG9yICA6IGNjLkNvbG9yLlJFRCxcclxuICAgICAgICBibGFja1RleHRDb2xvcjogY2MuQ29sb3IuV0hJVEUsXHJcbiAgICAgICAgdGV4RnJvbnRCRyAgICA6IGNjLlNwcml0ZUZyYW1lLFxyXG4gICAgICAgIC8vIHRleEJhY2tCRyAgICAgOiBjYy5TcHJpdGVGcmFtZSxcclxuICAgICAgICB0ZXhGYWNlcyAgICA6IHsvL0osUSxLXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgICAgICB0eXBlICAgOiBjYy5TcHJpdGVGcmFtZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4QWNlOntcclxuICAgICAgICAgICAgZGVmYXVsdDpbXSxcclxuICAgICAgICAgICAgdHlwZTpjYy5TcHJpdGVGcmFtZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4U3VpdEJpZyAgOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgICAgICB0eXBlICAgOiBjYy5TcHJpdGVGcmFtZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGV4U3VpdFNtYWxsOiB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IFtdLFxyXG4gICAgICAgICAgICB0eXBlICAgOiBjYy5TcHJpdGVGcmFtZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGF5ZXJTdWdnZXN0OntcclxuICAgICAgICAgICAgZGVmYXVsdDpudWxsLFxyXG4gICAgICAgICAgICB0eXBlOmNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGluZGV4ICAgICAgIDogey8vdmkgdHJpIHRyb25nIGdyb3VwIGtoaSBkYW5oIHJhXHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IDAsXHJcbiAgICAgICAgICAgIHR5cGUgICA6IGNjLkludGVnZXIsXHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBpc1NlbGVjdGVkICA6IHsgLy8gdHJhbmcgdGhhaSBjbyBzZWxlY3Qga2hvbmdcclxuICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsXHJcbiAgICAgICAgICAgIHZpc2libGU6IGZhbHNlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBvd25lciAgICAgICA6IHsvL3NvIGh1dSBxdWFuIGJhaSwgbXlQbGF5ZXIgaG9hYyBkb2NrIGR1b2kgdGFibGVcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZSAgIDogY2MuTm9kZSxcclxuICAgICAgICAgICAgdmlzaWJsZTogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIGlzRHJhZ2luZyAgIDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiB0cnVlLFxyXG4gICAgICAgICAgICB2aXNpYmxlOiBmYWxzZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FyZDoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlICAgOiBDYXJkLFxyXG4gICAgICAgICAgICB2aXNpYmxlOmZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIG15IHBsYXllciB8IGRvY2tcclxuICAgICAqIEBwYXJhbSBvd25lciB7Y2MuTm9kZX1cclxuICAgICAqL1xyXG4gICAgc2V0T3duZXI6ZnVuY3Rpb24ob3duZXIpe1xyXG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcclxuICAgIH0sXHJcbiAgICBvbkxvYWQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICB0aGlzLmxheWVyU3VnZ2VzdC5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcImxvYWRDYXJkOlwiICsgdGhpcy5jYXJkICtcInxcIiArIHRoaXMuaW5kZXgpO1xyXG4gICAgICAgIGlmKHRoaXMuY2FyZCl7XHJcbiAgICAgICAgICAgdGhpcy5pbml0KHRoaXMuY2FyZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9TVEFSVCwgdGhpcy5vblRvdWNoLCB0aGlzKTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfTU9WRSwgdGhpcy5vblRvdWNoLCB0aGlzKTtcclxuICAgICAgICB0aGlzLm5vZGUub24oY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfRU5ELCB0aGlzLm9uVG91Y2gsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9DQU5DRUwsIHRoaXMub25Ub3VjaCwgdGhpcyk7XHJcbiAgICAgICAgLy8gdGhpcy5ub2RlLm9uKFwiY2FyZC10b3VjaFwiLHRoaXMub25FbWl0LHRoaXMpO1xyXG5cclxuICAgIH0sXHJcbiAgICBvbkVtaXQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImNhcmQtdG91Y2g6XCIgKyB0aGlzLmNhcmQudG9TdHJpbmcoKSk7XHJcbiAgICB9LFxyXG4gICAgb25Ub3VjaDpmdW5jdGlvbihldmVudCl7XHJcbiAgICAgICAgaWYodGhpcy5vd25lcil7XHJcbiAgICAgICAgICAgIHZhciBjdXN0b21FdmVudCA9IG5ldyBjYy5FdmVudC5FdmVudEN1c3RvbSgnY2FyZC10b3VjaCcsIHRydWUpO1xyXG4gICAgICAgICAgICBjdXN0b21FdmVudC5zZXRVc2VyRGF0YSh7XHJcbiAgICAgICAgICAgICAgICBjYXJkOnRoaXMsXHJcbiAgICAgICAgICAgICAgICBldmVudDpldmVudFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xyXG4gICAgICAgICAgICAvLyB2YXIgY1BsYXllciA9IHRoaXMub3duZXIuZ2V0Q29tcG9uZW50KFwiQ1BsYXllclwiKTtcclxuICAgICAgICAgICAgLy8gY1BsYXllci5vblRvdWNoQ2FyZChldmVudCx0aGlzKTtcclxuICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJub3QgZm91bmQgb3duZXIncyBjYXJkOlwiICsgdGhpcy5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuICAgIHN0YXJ0OmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdGhpcy5ub2RlLmRpc3BhdGNoRXZlbnQoIG5ldyBjYy5FdmVudC5FdmVudEN1c3RvbSgnY2FyZHRvdWNoJywgdHJ1ZSkgKTtcclxuICAgIH0sXHJcbiAgICBzZXRDYXJkOmZ1bmN0aW9uKGNhcmQpe1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwic2V0Q2FyZDpcIiArIGNhcmQgK1wifHBvaW50OlwiICsgY2FyZC5wb2ludCArXCJ8c3VpdDpcIiArIGNhcmQuc3VpdCk7XHJcbiAgICAgICAgdGhpcy5jYXJkID0gY2FyZDtcclxuICAgIH0sXHJcbiAgICAvLyB1c2UgdGhpcyBmb3IgaW5pdGlhbGl6YXRpb25cclxuICAgIGluaXQ6IGZ1bmN0aW9uIChjYXJkKSB7XHJcbiAgICAgICAgLy9jaGF0XHJcbiAgICAgICAgdGhpcy5zdWl0LnNwcml0ZUZyYW1lID0gdGhpcy50ZXhTdWl0U21hbGxbY2FyZC5zdWl0XTtcclxuXHJcbiAgICAgICAgLy9zb1xyXG4gICAgICAgIGlmIChjYXJkLmlzUmVkU3VpdCkge1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50Lm5vZGUuY29sb3IgPSB0aGlzLnJlZFRleHRDb2xvcjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50Lm5vZGUuY29sb3IgPSB0aGlzLmJsYWNrVGV4dENvbG9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnBvaW50LnN0cmluZyA9IGNhcmQucG9pbnROYW1lO1xyXG5cclxuICAgICAgICAvL2hpbmhcclxuICAgICAgICBpZihjYXJkLmlzQWNlKXtcclxuICAgICAgICAgICAgdGhpcy5tYWluUGljLnNwcml0ZUZyYW1lID0gdGhpcy50ZXhBY2VbY2FyZC5zdWl0XTtcclxuICAgICAgICB9ZWxzZSBpZihjYXJkLmlzRmFjZSl7XHJcbiAgICAgICAgICAgIHRoaXMubWFpblBpYy5zcHJpdGVGcmFtZSA9IHRoaXMudGV4RmFjZXNbY2FyZC5wb2ludCAtIDhdO1xyXG4gICAgICAgICAgICBpZiAoY2FyZC5pc1JlZFN1aXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWFpblBpYy5ub2RlLmNvbG9yID0gdGhpcy5yZWRUZXh0Q29sb3I7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1haW5QaWMubm9kZS5jb2xvciA9IGNjLkNvbG9yLldISVRFO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIC8vYmluaCB0aHVvbmcgMi0+MTBcclxuICAgICAgICAgICAgdGhpcy5tYWluUGljLnNwcml0ZUZyYW1lID0gdGhpcy50ZXhTdWl0QmlnW2NhcmQuc3VpdF07XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRQb3NpdGlvbkNlbnRlcjpmdW5jdGlvbiAocG9zKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKHBvcy54IC0gNzMscG9zLnkgLSA5OCk7XHJcbiAgICB9LFxyXG4gICAgc2V0U3VnZ2VzdDpmdW5jdGlvbiAoYikge1xyXG4gICAgICAgIHRoaXMubGF5ZXJTdWdnZXN0LmFjdGl2ZSA9ICFiO1xyXG4gICAgfVxyXG59KTsiXX0=