
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/GameController.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '0998cn5M2hCaJbNVw/MXvof', 'GameController');
// scripts/GameController.js

"use strict";

var PlayableState = require('PlayableState');

var PoolHandler = require("PoolHandler");

var CCard = require("CCard");

var CTable = require("CTable");

var CPlayer = require("CPlayer");

var _require = require("Types"),
    Card = _require.Card,
    Table = _require.Table,
    Player = _require.Player;

var _require2 = require("GameFake"),
    ActionType = _require2.ActionType,
    GameFake = _require2.GameFake,
    SoundType = _require2.SoundType;

var PlayableAds = require("PlayableAds");

var CAudio = require("CAudio");

var Utility = require("Utility");

cc.Class({
  "extends": cc.Component,
  properties: {
    playableState: {
      "default": null,
      type: PlayableState,
      serializable: false,
      visible: false
    },
    btnPlayNow: cc.Button,
    btnDump: cc.Button,
    btnPass: cc.Button,
    layerGame: cc.Node,
    layerAction: cc.Node,
    table: {
      "default": null,
      type: cc.Node
    },
    players: {
      "default": [],
      type: cc.Node
    },
    layerCard: {
      "default": null,
      type: cc.Node
    },
    nodeSuggestGesture: {
      "default": null,
      type: cc.Node
    },
    nodeCHPlay: {
      "default": null,
      type: cc.Node
    },
    effectWin: {
      "default": null,
      type: cc.Node
    },
    cardPrefab: {
      "default": null,
      type: cc.Prefab
    },
    _poolCard: {
      "default": null,
      type: cc.NodePool,
      visible: false
    },
    _gameFake: {
      "default": null,
      type: GameFake,
      visible: false
    }
  },
  ctor: function ctor() {
    this.curIndex = -1;
    this.cardExpects = [];
    this.startPointTouch = null;
    this.zIndexCard = 10;
    this.audio = null;
  },
  onEnable: function onEnable() {
    console.log("onEnable players:" + this.players.length);
  },
  attachLayerCardToPlayer: function attachLayerCardToPlayer() {
    var len = this.players.length;

    for (var i = 0; i < len; i++) {
      var cPlayer = this.players[i].getComponent("CPlayer");
      cPlayer.setLayerCard(this.layerCard);
    }
  },
  onLoad: function onLoad() {
    this.nodeCHPlay.active = false;
    this.effectWin.getComponent("CEffectWin").gameController = this;
    this.nodeSuggestGesture.active = false;
    this.attachLayerCardToPlayer();
    this.audio = this.node.getComponent(CAudio);
    this.effectWin.active = false; //1. khoi tao info ban dau

    this._poolCard = new cc.NodePool(CCard);
    this._gameFake = new GameFake();

    var gameInfo = this._gameFake.getDefaultInfo();

    var tableConfig = gameInfo.table;
    var table = new Table(tableConfig.id, tableConfig.stake, tableConfig.pot);
    this.table.getComponent(CTable).setTable(table); //create new Card on Dock

    var cards = tableConfig.dock;
    var cTable = this.table.getComponent(CTable);
    cTable.setNumCard(cards.length);

    for (var j = 0; j < cards.length; j++) {
      var c = cards[j];

      var cardPrefabs = this._poolCard.get();

      if (!cardPrefabs) {
        cardPrefabs = cc.instantiate(this.cardPrefab);
      }

      var cCard = cardPrefabs.getComponent(CCard);
      cCard.setCard(c);
      cCard.index = j;
      cCard.setOwner(cTable);
      var p = cTable.getPositionCard(cCard);
      cardPrefabs.setPosition(p);
      this.layerCard.addChild(cardPrefabs);
    }

    console.log("onEnable players:" + this.players.length); //update info avatar

    var playersConfig = gameInfo.players;

    for (var k = 0; k < playersConfig.length; k++) {
      var playerConfig = playersConfig[k];
      var player = new Player(playerConfig.index, playerConfig.displayName, playerConfig.gold, playerConfig.avatarIndex, playerConfig.cards);
      console.log("get palyer at:" + player.index);
      var cPlayer = this.players[player.index].getComponent(CPlayer);
      cPlayer.setGameController(this);
      cPlayer.setPlayer(player);
    } //load prefab cardPrefabs
    // cc.loader.loadRes("prefabs/cardPrefab", function (err, prefab) {
    //     var newNode = cc.instantiate(prefab);
    //     newNode.setPosition(100,100);
    //     this.layerGame.addChild(newNode);
    //     // cc.director.getScene().addChild(newNode);
    // }.bind(this));


    this.node.on("card-touch", this.onTouchCard, this);

    var actionConfig = this._gameFake.getAction();

    var delayTime = actionConfig.time;
    this.curIndex = actionConfig.index;
    this.onEnterTurn(actionConfig.index);

    if (delayTime > 0) {
      this.scheduleOnce(function () {
        this.executeAction();
      }.bind(this), delayTime);
    }
  },
  start: function start() {},
  onEnterTurn: function onEnterTurn(index) {
    console.log("onEnterTurn: " + index);
    var cPlayer = this.players[index].getComponent(CPlayer);
    cPlayer.onEnterTurn();
  },
  executeAction: function executeAction() {
    this.nodeSuggestGesture.active = false;

    var actionConfig = this._gameFake.getAction();

    console.log("executeAction:" + JSON.stringify(actionConfig));
    var index = actionConfig.index;
    var type = actionConfig.type;

    switch (type) {
      case ActionType.PASS:
        this.onPassAt(index);
        break;

      case ActionType.DISCARD:
        this.onDiscardAt(index, actionConfig.cards);
        break;
    }

    var sound = actionConfig.sound;

    if (sound) {
      this.audio.playAudio(sound);
    }

    if (actionConfig.isEnded) {
      this.effectWin.active = true;
    } else {
      this.curIndex = actionConfig.next;

      var actionNext = this._gameFake.next();

      if (actionNext) {
        this.onEnterTurn(actionNext.index);
        console.log("actionNext:" + JSON.stringify(actionNext));
        var delayTime = actionNext.time;

        if (delayTime > 0) {
          this.scheduleOnce(function () {
            var actionConfig = this._gameFake.getAction();

            var index = actionConfig.index;

            if (index === 0) {
              if (actionConfig.suggest) {
                //neu co suggest
                this.nodeSuggestGesture.active = true;
              }

              this.cardExpects = actionConfig.cards;
              return;
            }

            this.executeAction();
          }.bind(this), delayTime);
        }
      }
    }
  },
  onPassAt: function onPassAt(index) {
    console.log("onPassAt:" + index);
    var cPlayer = this.players[index].getComponent(CPlayer);
    cPlayer.onPass();
  },
  onDiscardAt: function onDiscardAt(index, cards) {
    console.log("onDiscardAt:" + index + "|" + JSON.stringify(cards));
    var cTable = this.table.getComponent(CTable);
    var cardPrefabs = this.players[index].getComponent(CPlayer).onDiscard(cards);
    var len = cardPrefabs.length;
    cTable.setNumCard(len);

    for (var k = 0; k < len; k++) {
      var cardPrefab = cardPrefabs[k];
      var cCard = cardPrefab.getComponent(CCard);
      cCard.index = k;
      cCard.owner = cTable;
      var p = cTable.getPositionCard(cCard);
      cardPrefab.zIndex = ++this.zIndexCard; // cardPrefab.setPosition(p);

      cardPrefab.runAction(cc.spawn(cc.moveTo(1, p), cc.rotateTo(1, 0))); // cc.log("newZIndex:" + this.zIndexCard)

      ; // this.layerGame.addChild(cardPrefab);
    } // for (var j = 0; j < cards.length; j++) {
    //     var c = cards[j];
    //
    //     var cardPrefabs = this._poolCard.get();
    //     if(!cardPrefabs){cardPrefabs = cc.instantiate(this.cardPrefab);}
    //
    //     var cCard = cardPrefabs.getComponent(CCard);
    //
    //     cCard.setCard(c);
    //     cCard.index = (j);
    //     cCard.owner = cTable;
    //
    //     var p = cTable.getPositionCard(cCard);
    //     cardPrefabs.setPosition(p);
    //     this.layerGame.addChild(cardPrefabs);
    // }

  },
  onTouchCard: function onTouchCard(event) {
    var data = event.getUserData();
    var cCard = data.card;
    var owner = cCard.owner;

    if (owner instanceof CTable) {
      console.log("passing card on table");
      return;
    }

    if (owner instanceof CPlayer) {
      if (this.isMyTurn()) {
        if (this.isTouchExpectCards(cCard.card)) {
          switch (data.event.type) {
            case cc.Node.EventType.TOUCH_START:
              this.startPointTouch = data.event.getLocation();
              break;

            case cc.Node.EventType.TOUCH_MOVE:
              break;

            case cc.Node.EventType.TOUCH_END:
            case cc.Node.EventType.TOUCH_CANCEL:
              var pos = data.event.getLocation();

              if (pos.y - this.startPointTouch.y > 45) {
                this.executeAction();
                cc.log("Discard on my turn");
              } else {
                cc.log("!!Discard on my turn");
              }

              cc.log("touch:" + JSON.stringify(this.startPointTouch) + "| " + JSON.stringify(pos));
              break;
          }
        } else {
          cc.log("not expects card");
        }
      } else {
        cc.log("not my turn");
      } // owner.onTouchCard(data.event,data.card)

    } // console.log("onTouchCard at controler");

  },
  onPlayNow: function onPlayNow() {
    console.log("onPlay path main");
    PlayableAds.onCTAClick();
  },
  onTouchDump: function onTouchDump() {
    console.log("touch Dump");
  },
  onTouchPass: function onTouchPass() {
    console.log("touch Pass");
  },
  getNewCard: function getNewCard() {
    var cardPrefab = this._poolCard.get();

    if (!cardPrefab) {
      cardPrefab = cc.instantiate(this.cardPrefab);
    }

    return cardPrefab;
  },
  isMyTurn: function isMyTurn() {
    return this.curIndex === 0;
  },
  isTouchExpectCards: function isTouchExpectCards(card) {
    var len = this.cardExpects.length;

    for (var i = 0; i < len; i++) {
      var c = this.cardExpects[i];

      if (c.id === card.id) {
        return true;
      }
    }

    return false;
  },
  showNodeCHPlay: function showNodeCHPlay() {
    this.nodeCHPlay.active = true;
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0c1xcR2FtZUNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiUGxheWFibGVTdGF0ZSIsInJlcXVpcmUiLCJQb29sSGFuZGxlciIsIkNDYXJkIiwiQ1RhYmxlIiwiQ1BsYXllciIsIkNhcmQiLCJUYWJsZSIsIlBsYXllciIsIkFjdGlvblR5cGUiLCJHYW1lRmFrZSIsIlNvdW5kVHlwZSIsIlBsYXlhYmxlQWRzIiwiQ0F1ZGlvIiwiVXRpbGl0eSIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwicGxheWFibGVTdGF0ZSIsInR5cGUiLCJzZXJpYWxpemFibGUiLCJ2aXNpYmxlIiwiYnRuUGxheU5vdyIsIkJ1dHRvbiIsImJ0bkR1bXAiLCJidG5QYXNzIiwibGF5ZXJHYW1lIiwiTm9kZSIsImxheWVyQWN0aW9uIiwidGFibGUiLCJwbGF5ZXJzIiwibGF5ZXJDYXJkIiwibm9kZVN1Z2dlc3RHZXN0dXJlIiwibm9kZUNIUGxheSIsImVmZmVjdFdpbiIsImNhcmRQcmVmYWIiLCJQcmVmYWIiLCJfcG9vbENhcmQiLCJOb2RlUG9vbCIsIl9nYW1lRmFrZSIsImN0b3IiLCJjdXJJbmRleCIsImNhcmRFeHBlY3RzIiwic3RhcnRQb2ludFRvdWNoIiwiekluZGV4Q2FyZCIsImF1ZGlvIiwib25FbmFibGUiLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwiYXR0YWNoTGF5ZXJDYXJkVG9QbGF5ZXIiLCJsZW4iLCJpIiwiY1BsYXllciIsImdldENvbXBvbmVudCIsInNldExheWVyQ2FyZCIsIm9uTG9hZCIsImFjdGl2ZSIsImdhbWVDb250cm9sbGVyIiwibm9kZSIsImdhbWVJbmZvIiwiZ2V0RGVmYXVsdEluZm8iLCJ0YWJsZUNvbmZpZyIsImlkIiwic3Rha2UiLCJwb3QiLCJzZXRUYWJsZSIsImNhcmRzIiwiZG9jayIsImNUYWJsZSIsInNldE51bUNhcmQiLCJqIiwiYyIsImNhcmRQcmVmYWJzIiwiZ2V0IiwiaW5zdGFudGlhdGUiLCJjQ2FyZCIsInNldENhcmQiLCJpbmRleCIsInNldE93bmVyIiwicCIsImdldFBvc2l0aW9uQ2FyZCIsInNldFBvc2l0aW9uIiwiYWRkQ2hpbGQiLCJwbGF5ZXJzQ29uZmlnIiwiayIsInBsYXllckNvbmZpZyIsInBsYXllciIsImRpc3BsYXlOYW1lIiwiZ29sZCIsImF2YXRhckluZGV4Iiwic2V0R2FtZUNvbnRyb2xsZXIiLCJzZXRQbGF5ZXIiLCJvbiIsIm9uVG91Y2hDYXJkIiwiYWN0aW9uQ29uZmlnIiwiZ2V0QWN0aW9uIiwiZGVsYXlUaW1lIiwidGltZSIsIm9uRW50ZXJUdXJuIiwic2NoZWR1bGVPbmNlIiwiZXhlY3V0ZUFjdGlvbiIsImJpbmQiLCJzdGFydCIsIkpTT04iLCJzdHJpbmdpZnkiLCJQQVNTIiwib25QYXNzQXQiLCJESVNDQVJEIiwib25EaXNjYXJkQXQiLCJzb3VuZCIsInBsYXlBdWRpbyIsImlzRW5kZWQiLCJuZXh0IiwiYWN0aW9uTmV4dCIsInN1Z2dlc3QiLCJvblBhc3MiLCJvbkRpc2NhcmQiLCJvd25lciIsInpJbmRleCIsInJ1bkFjdGlvbiIsInNwYXduIiwibW92ZVRvIiwicm90YXRlVG8iLCJldmVudCIsImRhdGEiLCJnZXRVc2VyRGF0YSIsImNhcmQiLCJpc015VHVybiIsImlzVG91Y2hFeHBlY3RDYXJkcyIsIkV2ZW50VHlwZSIsIlRPVUNIX1NUQVJUIiwiZ2V0TG9jYXRpb24iLCJUT1VDSF9NT1ZFIiwiVE9VQ0hfRU5EIiwiVE9VQ0hfQ0FOQ0VMIiwicG9zIiwieSIsIm9uUGxheU5vdyIsIm9uQ1RBQ2xpY2siLCJvblRvdWNoRHVtcCIsIm9uVG91Y2hQYXNzIiwiZ2V0TmV3Q2FyZCIsInNob3dOb2RlQ0hQbGF5Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLGFBQWEsR0FBR0MsT0FBTyxDQUFDLGVBQUQsQ0FBM0I7O0FBQ0EsSUFBSUMsV0FBVyxHQUFHRCxPQUFPLENBQUMsYUFBRCxDQUF6Qjs7QUFDQSxJQUFJRSxLQUFLLEdBQUdG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WTtBQUN2QixTQUFLOUcsVUFBTCxDQUFnQndCLE1BQWhCLEdBQXlCLElBQXpCO0FBQ0g7QUF6VEksQ0FBVCIsInNvdXJjZVJvb3QiOiIvIiwic291cmNlc0NvbnRlbnQiOlsidmFyIFBsYXlhYmxlU3RhdGUgPSByZXF1aXJlKCdQbGF5YWJsZVN0YXRlJyk7XHJcbnZhciBQb29sSGFuZGxlciA9IHJlcXVpcmUoXCJQb29sSGFuZGxlclwiKTtcclxudmFyIENDYXJkID0gcmVxdWlyZShcIkNDYXJkXCIpO1xyXG52YXIgQ1RhYmxlID0gcmVxdWlyZShcIkNUYWJsZVwiKTtcclxudmFyIENQbGF5ZXIgPSByZXF1aXJlKFwiQ1BsYXllclwiKTtcclxudmFyIHtDYXJkLFRhYmxlLFBsYXllcn0gPSByZXF1aXJlKFwiVHlwZXNcIik7XHJcbnZhciB7QWN0aW9uVHlwZSxHYW1lRmFrZSxTb3VuZFR5cGV9ID0gcmVxdWlyZShcIkdhbWVGYWtlXCIpO1xyXG52YXIgUGxheWFibGVBZHMgPSByZXF1aXJlKFwiUGxheWFibGVBZHNcIik7XHJcbnZhciBDQXVkaW8gPSByZXF1aXJlKFwiQ0F1ZGlvXCIpO1xyXG52YXIgVXRpbGl0eSA9IHJlcXVpcmUoXCJVdGlsaXR5XCIpO1xyXG5cclxuY2MuQ2xhc3Moe1xyXG4gICAgZXh0ZW5kcyAgIDogY2MuQ29tcG9uZW50LFxyXG4gICAgcHJvcGVydGllczoge1xyXG4gICAgICAgIHBsYXlhYmxlU3RhdGU6IHtcclxuICAgICAgICAgICAgZGVmYXVsdCAgICAgOiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlICAgICAgICA6IFBsYXlhYmxlU3RhdGUsXHJcbiAgICAgICAgICAgIHNlcmlhbGl6YWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIHZpc2libGUgICAgIDogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJ0blBsYXlOb3cgICA6IGNjLkJ1dHRvbixcclxuICAgICAgICBidG5EdW1wICAgICAgOiBjYy5CdXR0b24sXHJcbiAgICAgICAgYnRuUGFzcyAgICAgIDogY2MuQnV0dG9uLFxyXG4gICAgICAgIGxheWVyR2FtZSAgICA6IGNjLk5vZGUsXHJcbiAgICAgICAgbGF5ZXJBY3Rpb24gIDogY2MuTm9kZSxcclxuICAgICAgICB0YWJsZTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwbGF5ZXJzICA6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogW10sXHJcbiAgICAgICAgICAgIHR5cGUgICA6IGNjLk5vZGVcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxheWVyQ2FyZDp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBub2RlU3VnZ2VzdEdlc3R1cmU6e1xyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbm9kZUNIUGxheTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTpjYy5Ob2RlXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlZmZlY3RXaW46e1xyXG4gICAgICAgICAgICBkZWZhdWx0Om51bGwsXHJcbiAgICAgICAgICAgIHR5cGU6Y2MuTm9kZVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2FyZFByZWZhYjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlICAgOiBjYy5QcmVmYWJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfcG9vbENhcmQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZSAgIDogY2MuTm9kZVBvb2wsXHJcbiAgICAgICAgICAgIHZpc2libGU6ZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIF9nYW1lRmFrZTp7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6bnVsbCxcclxuICAgICAgICAgICAgdHlwZTogR2FtZUZha2UsXHJcbiAgICAgICAgICAgIHZpc2libGU6ZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxuXHJcbiAgICBjdG9yOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5jdXJJbmRleCA9IC0xO1xyXG4gICAgICAgIHRoaXMuY2FyZEV4cGVjdHMgPSBbXTtcclxuICAgICAgICB0aGlzLnN0YXJ0UG9pbnRUb3VjaCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy56SW5kZXhDYXJkID0gMTA7XHJcbiAgICAgICAgdGhpcy5hdWRpbyA9IG51bGw7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uRW5hYmxlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkVuYWJsZSBwbGF5ZXJzOlwiICsgdGhpcy5wbGF5ZXJzLmxlbmd0aCk7XHJcbiAgICB9LFxyXG4gICAgYXR0YWNoTGF5ZXJDYXJkVG9QbGF5ZXI6ZnVuY3Rpb24oKXtcclxuICAgICAgICB2YXIgbGVuID0gdGhpcy5wbGF5ZXJzLmxlbmd0aDtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjUGxheWVyID0gdGhpcy5wbGF5ZXJzW2ldLmdldENvbXBvbmVudChcIkNQbGF5ZXJcIik7XHJcbiAgICAgICAgICAgIGNQbGF5ZXIuc2V0TGF5ZXJDYXJkKHRoaXMubGF5ZXJDYXJkKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25Mb2FkOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlQ0hQbGF5LmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuZWZmZWN0V2luLmdldENvbXBvbmVudChcIkNFZmZlY3RXaW5cIikuZ2FtZUNvbnRyb2xsZXIgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubm9kZVN1Z2dlc3RHZXN0dXJlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYXR0YWNoTGF5ZXJDYXJkVG9QbGF5ZXIoKTtcclxuICAgICAgICB0aGlzLmF1ZGlvID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChDQXVkaW8pO1xyXG4gICAgICAgIHRoaXMuZWZmZWN0V2luLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIC8vMS4ga2hvaSB0YW8gaW5mbyBiYW4gZGF1XHJcbiAgICAgICAgdGhpcy5fcG9vbENhcmQgPSBuZXcgY2MuTm9kZVBvb2woQ0NhcmQpO1xyXG4gICAgICAgIHRoaXMuX2dhbWVGYWtlID0gbmV3IEdhbWVGYWtlKCk7XHJcbiAgICAgICAgdmFyIGdhbWVJbmZvID0gdGhpcy5fZ2FtZUZha2UuZ2V0RGVmYXVsdEluZm8oKTtcclxuICAgICAgICB2YXIgdGFibGVDb25maWcgPSBnYW1lSW5mby50YWJsZTtcclxuICAgICAgICB2YXIgdGFibGUgPSBuZXcgVGFibGUodGFibGVDb25maWcuaWQsdGFibGVDb25maWcuc3Rha2UsdGFibGVDb25maWcucG90KTtcclxuICAgICAgICB0aGlzLnRhYmxlLmdldENvbXBvbmVudChDVGFibGUpLnNldFRhYmxlKHRhYmxlKTtcclxuXHJcbiAgICAgICAgLy9jcmVhdGUgbmV3IENhcmQgb24gRG9ja1xyXG4gICAgICAgIHZhciBjYXJkcyA9IHRhYmxlQ29uZmlnLmRvY2s7XHJcbiAgICAgICAgdmFyIGNUYWJsZSA9IHRoaXMudGFibGUuZ2V0Q29tcG9uZW50KENUYWJsZSk7XHJcbiAgICAgICAgY1RhYmxlLnNldE51bUNhcmQoY2FyZHMubGVuZ3RoKTtcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNhcmRzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgIHZhciBjID0gY2FyZHNbal07XHJcblxyXG4gICAgICAgICAgICB2YXIgY2FyZFByZWZhYnMgPSB0aGlzLl9wb29sQ2FyZC5nZXQoKTtcclxuICAgICAgICAgICAgaWYoIWNhcmRQcmVmYWJzKXtjYXJkUHJlZmFicyA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFByZWZhYik7fVxyXG5cclxuICAgICAgICAgICAgdmFyIGNDYXJkID0gY2FyZFByZWZhYnMuZ2V0Q29tcG9uZW50KENDYXJkKTtcclxuXHJcbiAgICAgICAgICAgIGNDYXJkLnNldENhcmQoYyk7XHJcbiAgICAgICAgICAgIGNDYXJkLmluZGV4ID0gKGopO1xyXG4gICAgICAgICAgICBjQ2FyZC5zZXRPd25lcihjVGFibGUpO1xyXG5cclxuICAgICAgICAgICAgdmFyIHAgPSBjVGFibGUuZ2V0UG9zaXRpb25DYXJkKGNDYXJkKTtcclxuICAgICAgICAgICAgY2FyZFByZWZhYnMuc2V0UG9zaXRpb24ocCk7XHJcbiAgICAgICAgICAgIHRoaXMubGF5ZXJDYXJkLmFkZENoaWxkKGNhcmRQcmVmYWJzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkVuYWJsZSBwbGF5ZXJzOlwiICsgdGhpcy5wbGF5ZXJzLmxlbmd0aCk7XHJcblxyXG4gICAgICAgIC8vdXBkYXRlIGluZm8gYXZhdGFyXHJcbiAgICAgICAgdmFyIHBsYXllcnNDb25maWcgPSBnYW1lSW5mby5wbGF5ZXJzO1xyXG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgcGxheWVyc0NvbmZpZy5sZW5ndGg7IGsrKykge1xyXG4gICAgICAgICAgICB2YXIgcGxheWVyQ29uZmlnID0gcGxheWVyc0NvbmZpZ1trXTtcclxuICAgICAgICAgICAgdmFyIHBsYXllciA9IG5ldyBQbGF5ZXIocGxheWVyQ29uZmlnLmluZGV4LHBsYXllckNvbmZpZy5kaXNwbGF5TmFtZSxwbGF5ZXJDb25maWcuZ29sZCxwbGF5ZXJDb25maWcuYXZhdGFySW5kZXgscGxheWVyQ29uZmlnLmNhcmRzKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJnZXQgcGFseWVyIGF0OlwiICsgcGxheWVyLmluZGV4KTtcclxuICAgICAgICAgICAgdmFyIGNQbGF5ZXIgPSB0aGlzLnBsYXllcnNbcGxheWVyLmluZGV4XS5nZXRDb21wb25lbnQoQ1BsYXllcik7XHJcbiAgICAgICAgICAgIGNQbGF5ZXIuc2V0R2FtZUNvbnRyb2xsZXIodGhpcyk7XHJcbiAgICAgICAgICAgIGNQbGF5ZXIuc2V0UGxheWVyKHBsYXllcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vbG9hZCBwcmVmYWIgY2FyZFByZWZhYnNcclxuICAgICAgICAvLyBjYy5sb2FkZXIubG9hZFJlcyhcInByZWZhYnMvY2FyZFByZWZhYlwiLCBmdW5jdGlvbiAoZXJyLCBwcmVmYWIpIHtcclxuICAgICAgICAvLyAgICAgdmFyIG5ld05vZGUgPSBjYy5pbnN0YW50aWF0ZShwcmVmYWIpO1xyXG4gICAgICAgIC8vICAgICBuZXdOb2RlLnNldFBvc2l0aW9uKDEwMCwxMDApO1xyXG4gICAgICAgIC8vICAgICB0aGlzLmxheWVyR2FtZS5hZGRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAvLyAgICAgLy8gY2MuZGlyZWN0b3IuZ2V0U2NlbmUoKS5hZGRDaGlsZChuZXdOb2RlKTtcclxuICAgICAgICAvLyB9LmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMubm9kZS5vbihcImNhcmQtdG91Y2hcIix0aGlzLm9uVG91Y2hDYXJkLHRoaXMpO1xyXG5cclxuICAgICAgICB2YXIgYWN0aW9uQ29uZmlnID0gdGhpcy5fZ2FtZUZha2UuZ2V0QWN0aW9uKCk7XHJcbiAgICAgICAgdmFyIGRlbGF5VGltZSA9IGFjdGlvbkNvbmZpZy50aW1lO1xyXG4gICAgICAgIHRoaXMuY3VySW5kZXggPSBhY3Rpb25Db25maWcuaW5kZXg7XHJcbiAgICAgICAgdGhpcy5vbkVudGVyVHVybihhY3Rpb25Db25maWcuaW5kZXgpO1xyXG4gICAgICAgIGlmKGRlbGF5VGltZT4wKXtcclxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQWN0aW9uKCk7XHJcbiAgICAgICAgICAgIH0uYmluZCh0aGlzKSxkZWxheVRpbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbiAgICBzdGFydDpmdW5jdGlvbigpe1xyXG5cclxuICAgIH0sXHJcbiAgICBvbkVudGVyVHVybjpmdW5jdGlvbihpbmRleCl7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkVudGVyVHVybjogXCIgKyBpbmRleCk7XHJcbiAgICAgICAgdmFyIGNQbGF5ZXIgPSB0aGlzLnBsYXllcnNbaW5kZXhdLmdldENvbXBvbmVudChDUGxheWVyKTtcclxuICAgICAgICBjUGxheWVyLm9uRW50ZXJUdXJuKCk7XHJcbiAgICB9LFxyXG4gICAgZXhlY3V0ZUFjdGlvbjpmdW5jdGlvbigpe1xyXG4gICAgICAgIHRoaXMubm9kZVN1Z2dlc3RHZXN0dXJlLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIHZhciBhY3Rpb25Db25maWcgPSB0aGlzLl9nYW1lRmFrZS5nZXRBY3Rpb24oKTtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImV4ZWN1dGVBY3Rpb246XCIgKyBKU09OLnN0cmluZ2lmeShhY3Rpb25Db25maWcpKTtcclxuICAgICAgICB2YXIgaW5kZXggPSBhY3Rpb25Db25maWcuaW5kZXg7XHJcblxyXG4gICAgICAgIHZhciB0eXBlID0gYWN0aW9uQ29uZmlnLnR5cGU7XHJcbiAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQWN0aW9uVHlwZS5QQVNTOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5vblBhc3NBdChpbmRleCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBBY3Rpb25UeXBlLkRJU0NBUkQ6XHJcbiAgICAgICAgICAgICAgICB0aGlzLm9uRGlzY2FyZEF0KGluZGV4LGFjdGlvbkNvbmZpZy5jYXJkcyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNvdW5kID0gYWN0aW9uQ29uZmlnLnNvdW5kO1xyXG4gICAgICAgIGlmKHNvdW5kKXtcclxuICAgICAgICAgICAgdGhpcy5hdWRpby5wbGF5QXVkaW8oc291bmQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihhY3Rpb25Db25maWcuaXNFbmRlZCl7XHJcbiAgICAgICAgICAgIHRoaXMuZWZmZWN0V2luLmFjdGl2ZSA9IHRydWU7XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRoaXMuY3VySW5kZXggPSBhY3Rpb25Db25maWcubmV4dDtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbk5leHQgPSB0aGlzLl9nYW1lRmFrZS5uZXh0KCk7XHJcbiAgICAgICAgICAgIGlmKGFjdGlvbk5leHQpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5vbkVudGVyVHVybihhY3Rpb25OZXh0LmluZGV4KTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWN0aW9uTmV4dDpcIiArIEpTT04uc3RyaW5naWZ5KGFjdGlvbk5leHQpKTtcclxuICAgICAgICAgICAgICAgIHZhciBkZWxheVRpbWUgPSBhY3Rpb25OZXh0LnRpbWU7XHJcbiAgICAgICAgICAgICAgICBpZihkZWxheVRpbWU+MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uQ29uZmlnID0gdGhpcy5fZ2FtZUZha2UuZ2V0QWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IGFjdGlvbkNvbmZpZy5pbmRleDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5kZXggPT09IDAgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFjdGlvbkNvbmZpZy5zdWdnZXN0KXsvL25ldSBjbyBzdWdnZXN0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlU3VnZ2VzdEdlc3R1cmUuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FyZEV4cGVjdHMgPSBhY3Rpb25Db25maWcuY2FyZHM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpLGRlbGF5VGltZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG4gICAgb25QYXNzQXQ6ZnVuY3Rpb24oaW5kZXgpe1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwib25QYXNzQXQ6XCIgKyBpbmRleCk7XHJcbiAgICAgICAgdmFyIGNQbGF5ZXIgPSB0aGlzLnBsYXllcnNbaW5kZXhdLmdldENvbXBvbmVudChDUGxheWVyKTtcclxuICAgICAgICBjUGxheWVyLm9uUGFzcygpO1xyXG4gICAgfSxcclxuICAgIG9uRGlzY2FyZEF0OmZ1bmN0aW9uKGluZGV4LGNhcmRzKXtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uRGlzY2FyZEF0OlwiICsgaW5kZXggK1wifFwiICsgSlNPTi5zdHJpbmdpZnkoY2FyZHMpKTtcclxuICAgICAgICB2YXIgY1RhYmxlID0gdGhpcy50YWJsZS5nZXRDb21wb25lbnQoQ1RhYmxlKTtcclxuICAgICAgICB2YXIgY2FyZFByZWZhYnMgPSB0aGlzLnBsYXllcnNbaW5kZXhdLmdldENvbXBvbmVudChDUGxheWVyKS5vbkRpc2NhcmQoY2FyZHMpO1xyXG5cclxuICAgICAgICB2YXIgbGVuID0gY2FyZFByZWZhYnMubGVuZ3RoO1xyXG4gICAgICAgIGNUYWJsZS5zZXROdW1DYXJkKGxlbik7XHJcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBsZW47IGsrKykge1xyXG4gICAgICAgICAgICB2YXIgY2FyZFByZWZhYiA9IGNhcmRQcmVmYWJzW2tdO1xyXG4gICAgICAgICAgICB2YXIgY0NhcmQgPSBjYXJkUHJlZmFiLmdldENvbXBvbmVudChDQ2FyZCk7XHJcbiAgICAgICAgICAgIGNDYXJkLmluZGV4ID0gKGspO1xyXG4gICAgICAgICAgICBjQ2FyZC5vd25lciA9IGNUYWJsZTtcclxuICAgICAgICAgICAgdmFyIHAgPSBjVGFibGUuZ2V0UG9zaXRpb25DYXJkKGNDYXJkKTtcclxuICAgICAgICAgICAgY2FyZFByZWZhYi56SW5kZXggPSArKyB0aGlzLnpJbmRleENhcmQ7XHJcbiAgICAgICAgICAgIC8vIGNhcmRQcmVmYWIuc2V0UG9zaXRpb24ocCk7XHJcbiAgICAgICAgICAgIGNhcmRQcmVmYWIucnVuQWN0aW9uKGNjLnNwYXduKFxyXG4gICAgICAgICAgICAgICAgY2MubW92ZVRvKDEscCksXHJcbiAgICAgICAgICAgICAgICBjYy5yb3RhdGVUbygxLDApXHJcbiAgICAgICAgICAgICkpO1xyXG4gICAgICAgICAgICAvLyBjYy5sb2coXCJuZXdaSW5kZXg6XCIgKyB0aGlzLnpJbmRleENhcmQpXHJcbjtcclxuICAgICAgICAgICAgLy8gdGhpcy5sYXllckdhbWUuYWRkQ2hpbGQoY2FyZFByZWZhYik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBmb3IgKHZhciBqID0gMDsgaiA8IGNhcmRzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgLy8gICAgIHZhciBjID0gY2FyZHNbal07XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyAgICAgdmFyIGNhcmRQcmVmYWJzID0gdGhpcy5fcG9vbENhcmQuZ2V0KCk7XHJcbiAgICAgICAgLy8gICAgIGlmKCFjYXJkUHJlZmFicyl7Y2FyZFByZWZhYnMgPSBjYy5pbnN0YW50aWF0ZSh0aGlzLmNhcmRQcmVmYWIpO31cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgICB2YXIgY0NhcmQgPSBjYXJkUHJlZmFicy5nZXRDb21wb25lbnQoQ0NhcmQpO1xyXG4gICAgICAgIC8vXHJcbiAgICAgICAgLy8gICAgIGNDYXJkLnNldENhcmQoYyk7XHJcbiAgICAgICAgLy8gICAgIGNDYXJkLmluZGV4ID0gKGopO1xyXG4gICAgICAgIC8vICAgICBjQ2FyZC5vd25lciA9IGNUYWJsZTtcclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vICAgICB2YXIgcCA9IGNUYWJsZS5nZXRQb3NpdGlvbkNhcmQoY0NhcmQpO1xyXG4gICAgICAgIC8vICAgICBjYXJkUHJlZmFicy5zZXRQb3NpdGlvbihwKTtcclxuICAgICAgICAvLyAgICAgdGhpcy5sYXllckdhbWUuYWRkQ2hpbGQoY2FyZFByZWZhYnMpO1xyXG4gICAgICAgIC8vIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25Ub3VjaENhcmQ6ZnVuY3Rpb24oZXZlbnQpe1xyXG4gICAgICAgIHZhciBkYXRhID0gZXZlbnQuZ2V0VXNlckRhdGEoKTtcclxuICAgICAgICB2YXIgY0NhcmQgPSBkYXRhLmNhcmQ7XHJcbiAgICAgICAgdmFyIG93bmVyID0gY0NhcmQub3duZXI7XHJcbiAgICAgICAgaWYob3duZXIgaW5zdGFuY2VvZiBDVGFibGUpe1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBhc3NpbmcgY2FyZCBvbiB0YWJsZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihvd25lciBpbnN0YW5jZW9mIENQbGF5ZXIpe1xyXG4gICAgICAgICAgICBpZih0aGlzLmlzTXlUdXJuKCkpe1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5pc1RvdWNoRXhwZWN0Q2FyZHMoY0NhcmQuY2FyZCkpe1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0YS5ldmVudC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfU1RBUlQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0UG9pbnRUb3VjaCA9IGRhdGEuZXZlbnQuZ2V0TG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGNjLk5vZGUuRXZlbnRUeXBlLlRPVUNIX01PVkU6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBjYy5Ob2RlLkV2ZW50VHlwZS5UT1VDSF9FTkQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgY2MuTm9kZS5FdmVudFR5cGUuVE9VQ0hfQ0FOQ0VMOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvcyA9IGRhdGEuZXZlbnQuZ2V0TG9jYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHBvcy55IC0gdGhpcy5zdGFydFBvaW50VG91Y2gueSA+IDQ1KXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4ZWN1dGVBY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJEaXNjYXJkIG9uIG15IHR1cm5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCIhIURpc2NhcmQgb24gbXkgdHVyblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNjLmxvZyhcInRvdWNoOlwiICsgSlNPTi5zdHJpbmdpZnkodGhpcy5zdGFydFBvaW50VG91Y2gpICtcInwgXCIrIEpTT04uc3RyaW5naWZ5KHBvcykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICBjYy5sb2coXCJub3QgZXhwZWN0cyBjYXJkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIGNjLmxvZyhcIm5vdCBteSB0dXJuXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIG93bmVyLm9uVG91Y2hDYXJkKGRhdGEuZXZlbnQsZGF0YS5jYXJkKVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIm9uVG91Y2hDYXJkIGF0IGNvbnRyb2xlclwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25QbGF5Tm93OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJvblBsYXkgcGF0aCBtYWluXCIpO1xyXG4gICAgICAgIFBsYXlhYmxlQWRzLm9uQ1RBQ2xpY2soKTtcclxuICAgIH0sXHJcblxyXG4gICAgb25Ub3VjaER1bXA6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcInRvdWNoIER1bXBcIik7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uVG91Y2hQYXNzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJ0b3VjaCBQYXNzXCIpO1xyXG4gICAgfSxcclxuXHJcbiAgICBnZXROZXdDYXJkOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgdmFyIGNhcmRQcmVmYWIgPSB0aGlzLl9wb29sQ2FyZC5nZXQoKTtcclxuICAgICAgICBpZighY2FyZFByZWZhYil7Y2FyZFByZWZhYiA9IGNjLmluc3RhbnRpYXRlKHRoaXMuY2FyZFByZWZhYik7fVxyXG4gICAgICAgIHJldHVybiBjYXJkUHJlZmFiO1xyXG4gICAgfSxcclxuXHJcbiAgICBpc015VHVybjpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VySW5kZXggPT09IDA7XHJcbiAgICB9LFxyXG4gICAgaXNUb3VjaEV4cGVjdENhcmRzOmZ1bmN0aW9uIChjYXJkKSB7XHJcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMuY2FyZEV4cGVjdHMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGMgPSB0aGlzLmNhcmRFeHBlY3RzW2ldO1xyXG4gICAgICAgICAgICBpZihjLmlkID09PSBjYXJkLmlkKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBzaG93Tm9kZUNIUGxheTpmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlQ0hQbGF5LmFjdGl2ZSA9IHRydWU7XHJcbiAgICB9XHJcbn0pOyJdfQ==