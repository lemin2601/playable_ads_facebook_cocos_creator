{"version":3,"sources":["assets\\scripts\\CEffectWin.js"],"names":["Utility","require","cc","Class","Component","properties","spine","type","Node","lbLose1","Label","lbLose2","imgLose1","Sprite","imgLose2","lbWin","lbPot","player1","player2","emotions","ctor","gameController","onEnable","_playEffectX8","_playEffectLabelGold","_playAllEmotions","_delayShowCHPlay","showNodeCHPlay","playEmo","emo","getComponent","setCompleteListener","trackEntry","active","setTimeout","setAnimation","l","length","i","clearTracks","lose1","lose2","pot","win","hideLabelonDone","label","node","runUpdateGold","undefined","gold","runAction","sequence","delayTime","callFunc"],"mappings":"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","sourceRoot":"/","sourcesContent":["var Utility = require(\"Utility\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        spine:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        lbLose1:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        lbLose2:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        imgLose1:{\r\n            default:null,\r\n            type:cc.Sprite\r\n        },\r\n        imgLose2:{\r\n            default:null,\r\n            type:cc.Sprite\r\n        },\r\n        lbWin:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        lbPot:{\r\n            default:null,\r\n            type:cc.Label\r\n        },\r\n        player1:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        player2:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        emotions:{\r\n            default:[],\r\n            type:[cc.Node]\r\n        }\r\n    },\r\n\r\n    ctor:function(){\r\n        this.gameController = null;\r\n    },\r\n\r\n    // onLoad () {},\r\n    // start () {},\r\n    // update (dt) {},\r\n\r\n    onEnable:function(){\r\n        this._playEffectX8();\r\n        this._playEffectLabelGold();\r\n        this._playAllEmotions();\r\n        this._delayShowCHPlay();\r\n    },\r\n\r\n    showNodeCHPlay:function(){\r\n        this.gameController.showNodeCHPlay();\r\n    },\r\n    _playAllEmotions:function(){\r\n        function playEmo(emo) {\r\n            if(emo){\r\n                var spine = emo.getComponent('sp.Skeleton'); spine.setCompleteListener(function(trackEntry){\r\n                    emo.active = false;\r\n                });\r\n                setTimeout(function () {\r\n                    emo.active = true;\r\n                    spine.setAnimation(0, 'animation', false);\r\n                },1000);\r\n            }\r\n        }\r\n        var l = this.emotions.length;\r\n        for (var i = 0; i < l; i++) {\r\n            var emo = this.emotions[i];\r\n            playEmo(emo);\r\n        }\r\n    },\r\n    _playEffectX8: function () {\r\n        var emo = this.spine;\r\n        var spine = emo.getComponent('sp.Skeleton');\r\n        spine.clearTracks();\r\n        spine.setCompleteListener(function(trackEntry){\r\n            // spine.clearTracks();\r\n            // emo.active = false;\r\n        });\r\n        emo.active = true;\r\n        spine.setAnimation(0, 'animation', false);\r\n    },\r\n    _playEffectLabelGold: function () {\r\n        var lose1 = 47000000;\r\n        var lose2 = 58000000;\r\n        var pot = 40000000;\r\n        var win = pot + lose1 + lose2;\r\n        function hideLabelonDone(label){\r\n            label.node.active = false;\r\n        }\r\n        Utility.runUpdateGold(this.lbLose1, 0, -lose1, undefined, undefined, hideLabelonDone, undefined, \"\", \"\",\"$\");\r\n        Utility.runUpdateGold(this.lbLose2, 0, -lose1, undefined, undefined, hideLabelonDone, undefined, \"\", \"\",\"$\");\r\n        Utility.runUpdateGold(this.lbWin, 0, win, undefined, undefined, undefined, undefined, \"\", \"+\",\"$\");\r\n        // Utility.runUpdateGold(this.lbLose2,0,-lose2);\r\n        // Utility.runUpdateGold(this.lbWin,0,win);\r\n        Utility.runUpdateGold(this.player1.getComponent(\"CPlayer\").gold,lose1,0);\r\n        Utility.runUpdateGold(this.player2.getComponent(\"CPlayer\").gold,lose2,0);\r\n    },\r\n    _delayShowCHPlay: function () {\r\n        this.node.runAction(cc.sequence(\r\n            cc.delayTime(4),\r\n            cc.callFunc(function () {\r\n                this.imgLose1.node.active = false;\r\n                this.imgLose2.node.active = false;\r\n                this.lbWin.node.active = false;\r\n                this.showNodeCHPlay();\r\n            },this)\r\n        ));\r\n    }\r\n});\r\n"]}